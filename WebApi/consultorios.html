
    <h1>Consultorios</h1>

    <div class="container" ng-controller="controlconsultorios">
        <h2>Reservas consultorios</h2>
        <p>Seleccione un consultorio y una fecha para ver los horarios disponibles</p>
        <table class="table">
            <thead>
                <tr>
                    <th>Direccion</th>
                    <th>Hora inicio</th>
                    <th>Hora fin</th>
                    <th>    </th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="x in myData">
                    <td>{{x.Direccion}}</td>
                    <td>{{x.HoraInicio}}</td>
                    <td>{{x.HoraFin}}</td>
                    <td><input type="radio" name="consultorio" value="{{x.IdConsultorio}}"> </td>
                </tr>
            </tbody>
        </table>
        <input type="date" name="dia">



        <div ng-controller="controlHoras">
            <button ng-click="myFunc()">Consultar</button>
            <table class="table">
                <thead>
                    <tr>
                        <th>Horas disponibles</th>
                        <th>seleccione 1 o mas</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="x in Horarios">
                        <td>{{x}}</td>
                        <td><input type="checkbox" name="hora" value="{{x}}"> </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <input type="button" value="Reservar" onclick="reservar();" />
    </div>

 

<script>

    function reservar($location,$root) {

        var uri = 'api/Horario/PostReservarHorario/';

        var horas = document.getElementsByName('hora');

        var consultorios = document.getElementsByName("consultorio");
        var consultorio;
        for (var i = 0; i < consultorios.length; i++) {
            if (consultorios[i].checked)
                consultorio = consultorios[i].value;
        }
        var dias = document.getElementsByName("dia");
        var dia = dias[0].value;

        for (var i = 0; i < horas.length; i++) {
            if (horas[i].checked) {

                var Horario = {
                    dia: dia,
                    idConsultorio: consultorio,
                    cedula: 11111111,
                    hora: horas[i].value
                };
                var info_reserva = JSON.stringify(Horario);
                $.ajax({
                    url: 'api/Horario/PostReservarHorario/',
                    cache: false,
                    type: 'POST',
                    contentType: 'application/json; charset=utf-8',
                    data: info_reserva,
                    dataType: 'json',
                    success: function (data) {
                        
                    }
                });

            }
        }
        var variable = sessionStorage.getItem('logeo');
        alert(variable);
        //window.location.replace("#!profesionalhorarioslibres"); 
        
    }

   
</script>
