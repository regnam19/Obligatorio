<h1>Paciente</h1>

<div class="container" ng-controller="controllerpaciente">
    <h2>Reservas Profesional</h2>
    <p>Seleccione un Profesional</p>
    <table class="table">
        <thead>
            <tr>
                <th>Nombre</th>
                <th>Apellido</th>
                <th>Especialidad</th>
                <th>    </th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="x in profesionales">
                <td>{{x.nombre}}</td>
                <td>{{x.apellido}}</td>
                <td>{{x.especialidad}}</td>
                <td><input type="radio" name="cedulaProfesional" value="{{x.cedula}}"> </td>
            </tr>
        </tbody>
    </table>

    <div ng-controller="controllerBuscarHorasLibresProfesional">
        <button ng-click="myFunc()">Buscar</button>
        <table class="table">
            <thead>
                <tr>
                    <th>Dia</th>
                    <th>Hora</th>
                    <th>Direccion</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="x in horariosLibres">
                    <td>{{x.Dia|date}}</td>
                    <td>{{x.Hora}}</td>
                    <td>{{x.Direccion}}</td>
                    <td><input type="checkbox" name="hora" value="{{x.IdHorario}}"> </td>
                </tr>
            </tbody>
        </table>
    </div>
    <button ng-click="myFunc()">Reservar</button>
    <!-- <input type="button" value="Reservar" onclick="reservar();" /> -->
</div>

<script>

    function reservar($location) {

        var uri = 'api/Horario/PostReservarHorarioProfesional/';
        var horas = document.getElementsByName('hora');
        for (var i = 0; i < horas.length; i++) {
            if (horas[i].checked) {

                var Horario = {
                    cedula: 12345678,
                    IdHorario: horas[i].value
                };
                var info_reserva = JSON.stringify(Horario);
                $.ajax({
                    url: 'api/Horario/PostReservarHorarioProfesional/',
                    cache: false,
                    type: 'POST',
                    contentType: 'application/json; charset=utf-8',
                    data: info_reserva,
                    dataType: 'json',
                    success: function (data) {
                        alert('Se agrego el horario');
                    }
                });

            }
        }
        alert("respuesta FUERA funcion");
        window.location.replace("#!paciente");
    }
    
</script>

